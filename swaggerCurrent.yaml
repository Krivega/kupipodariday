openapi: 3.0.0
paths:
  /:
    get:
      operationId: AppController_getHello
      parameters: []
      responses:
        "200":
          description: ""
      tags:
        - App
  /users/find:
    post:
      operationId: UsersController_findMany
      parameters: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/FindUsersDto"
      responses:
        "200":
          description: List of found users
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/UserPublicProfileResponseDto"
      summary: Search users by query
      tags: &a1
        - users
  /users/me:
    get:
      operationId: UsersController_findOwn
      parameters: []
      responses:
        "200":
          description: Current user profile
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/UserProfileResponseDto"
      summary: Get current user profile
      tags: *a1
    patch:
      operationId: UsersController_update
      parameters: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/UpdateUserDto"
      responses:
        "200":
          description: Updated user profile
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/UserProfileResponseDto"
        "400":
          description: Ошибка валидации переданных значений
      summary: Update current user profile
      tags: *a1
  /users/me/wishes:
    get:
      operationId: UsersController_getOwnWishes
      parameters: []
      responses:
        "200":
          description: List of current user wishes
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/WishResponseDto"
      summary: Get current user wishes
      tags: *a1
  /users/{username}/wishes:
    get:
      operationId: UsersController_getWishes
      parameters:
        - name: username
          required: true
          in: path
          description: Username
          schema:
            minLength: 2
            maxLength: 30
            example: johndoe
            type: string
      responses:
        "200":
          description: List of user wishes
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/UserWishesDto"
      summary: Get wishes by username
      tags: *a1
  /users/{username}:
    get:
      operationId: UsersController_findOne
      parameters:
        - name: username
          required: true
          in: path
          description: Username
          schema:
            minLength: 2
            maxLength: 30
            example: johndoe
            type: string
      responses:
        "200":
          description: User public profile
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/UserPublicProfileResponseDto"
      summary: Get public profile by username
      tags: *a1
  /offers:
    post:
      operationId: OffersController_create
      parameters: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/CreateOfferDto"
      responses:
        "201":
          description: Created offer
          content:
            application/json:
              schema:
                type: object
      summary: Create offer
      tags: &a2
        - offers
    get:
      operationId: OffersController_findAll
      parameters: []
      responses:
        "200":
          description: List of offers
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/OfferResponseDto"
      summary: Get all offers
      tags: *a2
  /offers/{id}:
    get:
      operationId: OffersController_findOne
      parameters:
        - name: id
          required: true
          in: path
          description: Offer ID
          schema:
            example: 1
            type: number
      responses:
        "200":
          description: Offer
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/OfferResponseDto"
      summary: Get offer by id
      tags: *a2
  /wishes/last:
    get:
      operationId: WishesController_findLast
      parameters: []
      responses:
        "200":
          description: List of last wishes
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/WishResponseDto"
      summary: Get last wishes
      tags: &a3
        - wishes
  /wishes/top:
    get:
      operationId: WishesController_findTop
      parameters: []
      responses:
        "200":
          description: List of top wishes
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/WishResponseDto"
      summary: Get top wishes
      tags: *a3
  /wishes:
    post:
      operationId: WishesController_create
      parameters: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/CreateWishDto"
      responses:
        "201":
          description: Created wish
          content:
            application/json:
              schema:
                type: object
      summary: Create wish
      tags: *a3
  /wishes/{id}:
    get:
      operationId: WishesController_findOne
      parameters:
        - name: id
          required: true
          in: path
          description: Wish ID
          schema:
            example: 1
            type: number
      responses:
        "200":
          description: Wish
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/WishResponseDto"
      summary: Get wish by id
      tags: *a3
    patch:
      operationId: WishesController_update
      parameters:
        - name: id
          required: true
          in: path
          description: Wish ID
          schema:
            example: 1
            type: number
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/UpdateWishDto"
      responses:
        "200":
          description: Updated wish
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/WishResponseDto"
      summary: Update wish
      tags: *a3
    delete:
      operationId: WishesController_removeOne
      parameters:
        - name: id
          required: true
          in: path
          description: Wish ID
          schema:
            example: 1
            type: number
      responses:
        "200":
          description: Deleted wish
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/WishResponseDto"
      summary: Remove wish
      tags: *a3
  /wishes/{id}/copy:
    post:
      operationId: WishesController_copyWish
      parameters:
        - name: id
          required: true
          in: path
          description: Wish ID
          schema:
            example: 1
            type: number
      responses:
        "201":
          description: Copied wish
          content:
            application/json:
              schema:
                type: object
      summary: Copy wish
      tags: *a3
  /wishlistlists:
    get:
      operationId: WishlistsController_findAll
      parameters: []
      responses:
        "200":
          description: List of wishlists
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/WishlistResponseDto"
      summary: Get all wishlists
      tags: &a4
        - wishlistlists
    post:
      operationId: WishlistsController_create
      parameters: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/CreateWishlistDto"
      responses:
        "201":
          description: Created wishlist
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/WishlistResponseDto"
      summary: Create wishlist
      tags: *a4
  /wishlistlists/{id}:
    get:
      operationId: WishlistsController_findOne
      parameters:
        - name: id
          required: true
          in: path
          description: Wishlist ID
          schema:
            example: 1
            type: number
      responses:
        "200":
          description: Wishlist
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/WishlistResponseDto"
      summary: Get wishlist by id
      tags: *a4
    patch:
      operationId: WishlistsController_update
      parameters:
        - name: id
          required: true
          in: path
          description: Wishlist ID
          schema:
            example: 1
            type: number
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/UpdateWishlistDto"
      responses:
        "200":
          description: Updated wishlist
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/WishlistResponseDto"
      summary: Update wishlist
      tags: *a4
    delete:
      operationId: WishlistsController_removeOne
      parameters:
        - name: id
          required: true
          in: path
          description: Wishlist ID
          schema:
            example: 1
            type: number
      responses:
        "200":
          description: Deleted wishlist
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/WishlistResponseDto"
      summary: Remove wishlist
      tags: *a4
  /signin:
    post:
      operationId: AuthController_login
      parameters: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/SigninUserDto"
      responses:
        "200":
          description: JWT access token
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/SigninUserResponseDto"
        "401":
          description: Invalid username or password
      summary: Sign in
      tags: &a5
        - auth
  /signout:
    post:
      operationId: AuthController_signout
      parameters: []
      responses:
        "204":
          description: ""
      summary: Sign out
      tags: *a5
  /signup:
    post:
      operationId: AuthController_signup
      parameters: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/CreateUserDto"
      responses:
        "201":
          description: Created user profile
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/SignupUserResponseDto"
        "409":
          description: User with this email or username is already registered
      summary: Sign up
      tags: *a5
info:
  title: КупиПодариДай
  description: API сервиса вишлистов
  version: 1.0.0
  contact: {}
tags: []
servers:
  - url: http://localhost:3000
    description: Локальный сервер
  - url: https://virtserver.swaggerhub.com/zlocate/KupiPodariDay/1.0.0
    description: SwaggerHub API Auto Mocking
components:
  securitySchemes:
    bearer:
      scheme: bearer
      bearerFormat: JWT
      type: http
  schemas:
    FindUsersDto:
      type: object
      properties:
        query:
          type: string
          description: User username, email or about
          example: some@ya.ru
      required:
        - query
    UserPublicProfileResponseDto:
      type: object
      properties:
        id:
          type: number
          example: 1
        createdAt:
          format: date-time
          type: string
        updatedAt:
          format: date-time
          type: string
        username:
          type: string
          example: johndoe
          minLength: 2
          maxLength: 30
        about:
          type: string
          example: Пока ничего не рассказал о себе
          minLength: 2
          maxLength: 200
        avatar:
          type: string
          example: https://i.pravatar.cc/300
      required:
        - id
        - createdAt
        - updatedAt
        - username
        - about
        - avatar
    UserProfileResponseDto:
      type: object
      properties:
        id:
          type: number
          example: 1
        createdAt:
          format: date-time
          type: string
        updatedAt:
          format: date-time
          type: string
        username:
          type: string
          example: johndoe
          minLength: 2
          maxLength: 30
        about:
          type: string
          example: Пока ничего не рассказал о себе
          minLength: 2
          maxLength: 200
        avatar:
          type: string
          example: https://i.pravatar.cc/300
        email:
          type: string
          example: test@example.com
      required:
        - id
        - createdAt
        - updatedAt
        - username
        - about
        - avatar
        - email
    UpdateUserDto:
      type: object
      properties:
        username:
          type: string
          description: Username, unique string 2-30 characters
          example: johndoe
          minLength: 2
          maxLength: 30
        about:
          type: string
          description: About user, string 2-200 characters
          example: Пока ничего не рассказал о себе
          minLength: 2
          maxLength: 200
        avatar:
          type: string
          description: Avatar URL
          example: https://i.pravatar.cc/300
        email:
          type: string
          description: User email, must be unique
          example: test@example.com
        password:
          type: string
          description: User password, min 6 characters
          example: secret123
          minLength: 6
    WishPartialDto:
      type: object
      properties:
        id:
          type: number
          example: 1
        createdAt:
          format: date-time
          type: string
        updatedAt:
          format: date-time
          type: string
        name:
          type: string
          example: Gift name
          minLength: 1
          maxLength: 250
        link:
          type: string
          example: https://example.com/item
        image:
          type: string
          example: https://example.com/image.jpg
        price:
          type: number
          example: 99.99
          minimum: 1
        raised:
          type: number
          example: 0
          minimum: 0
        copied:
          type: number
          example: 0
        description:
          type: string
          example: Description text
          minLength: 1
          maxLength: 1024
      required:
        - id
        - createdAt
        - updatedAt
        - name
        - link
        - image
        - price
        - raised
        - copied
        - description
    OfferResponseDto:
      type: object
      properties:
        id:
          type: number
          example: 1
        createdAt:
          format: date-time
          type: string
        updatedAt:
          format: date-time
          type: string
        amount:
          type: number
          example: 50.5
        hidden:
          type: boolean
          example: false
        item:
          description: Wish item (partial, without owner/offers)
          allOf:
            - $ref: "#/components/schemas/WishPartialDto"
        user:
          description: Contributor (public profile; email only for wish owner)
          allOf:
            - $ref: "#/components/schemas/UserPublicProfileResponseDto"
      required:
        - id
        - createdAt
        - updatedAt
        - amount
        - hidden
        - item
        - user
    WishResponseDto:
      type: object
      properties:
        id:
          type: number
          example: 1
        name:
          type: string
          example: Gift name
        link:
          type: string
          example: https://example.com/item
        image:
          type: string
          example: https://example.com/image.jpg
        price:
          type: number
          example: 99.99
          minimum: 1
        raised:
          type: number
          example: 0
          minimum: 0
        copied:
          type: number
          example: 0
        description:
          type: string
          example: Description text
        createdAt:
          format: date-time
          type: string
        updatedAt:
          format: date-time
          type: string
        owner:
          $ref: "#/components/schemas/UserPublicProfileResponseDto"
        offers:
          type: array
          items:
            $ref: "#/components/schemas/OfferResponseDto"
      required:
        - id
        - name
        - link
        - image
        - price
        - raised
        - copied
        - description
        - createdAt
        - updatedAt
        - owner
        - offers
    UserWishesDto:
      type: object
      properties:
        id:
          type: number
          example: 1
        createdAt:
          format: date-time
          type: string
        updatedAt:
          format: date-time
          type: string
        name:
          type: string
          example: Gift name
          minLength: 1
          maxLength: 250
        link:
          type: string
          example: https://example.com/item
        image:
          type: string
          example: https://example.com/image.jpg
        price:
          type: number
          example: 99.99
        raised:
          type: number
          example: 0
        copied:
          type: number
          example: 0
        description:
          type: string
          example: Description text
          minLength: 1
          maxLength: 1024
        offers:
          type: array
          items:
            $ref: "#/components/schemas/OfferResponseDto"
      required:
        - id
        - createdAt
        - updatedAt
        - name
        - link
        - image
        - price
        - raised
        - copied
        - description
        - offers
    CreateOfferDto:
      type: object
      properties:
        amount:
          type: number
          description: Offer amount, number with up to 2 decimal places
          example: 50.5
          minimum: 1
        hidden:
          type: boolean
          description: Flag that determines whether the contributor information is hidden
          example: false
          default: false
        itemId:
          type: number
          description: Identifier of the wish item the offer belongs to
          example: 1
      required:
        - amount
        - itemId
    CreateWishDto:
      type: object
      properties:
        name:
          type: string
          description: Wish name, string 1-250 characters
          example: Gift name
          minLength: 1
          maxLength: 250
        link:
          type: string
          description: Wish link, string
          example: https://example.com/item
        image:
          type: string
          description: Wish image, string
          example: https://example.com/image.jpg
        price:
          type: number
          description: Wish price, number
          example: 99.99
        description:
          type: string
          description: Wish description, string 1-1024 characters
          example: Description text
          minLength: 1
          maxLength: 1024
      required:
        - name
        - link
        - image
        - price
        - description
    UpdateWishDto:
      type: object
      properties:
        name:
          type: string
          description: Wish name, string 1-250 characters
          example: Gift name
          minLength: 1
          maxLength: 250
        link:
          type: string
          description: Wish link, string
          example: https://example.com/item
        image:
          type: string
          description: Wish image, string
          example: https://example.com/image.jpg
        price:
          type: number
          description: Wish price, number
          example: 99.99
        description:
          type: string
          description: Wish description, string 1-1024 characters
          example: Description text
          minLength: 1
          maxLength: 1024
    WishlistResponseDto:
      type: object
      properties:
        id:
          type: number
          example: 1
        createdAt:
          format: date-time
          type: string
        updatedAt:
          format: date-time
          type: string
        name:
          type: string
          example: Мой вишлист
          minLength: 0
          maxLength: 250
        description:
          type: string
        image:
          type: string
          example: https://i.pravatar.cc/150?img=3
        owner:
          $ref: "#/components/schemas/UserPublicProfileResponseDto"
        items:
          type: array
          items:
            $ref: "#/components/schemas/WishPartialDto"
      required:
        - id
        - createdAt
        - updatedAt
        - name
        - image
        - owner
        - items
    CreateWishlistDto:
      type: object
      properties:
        name:
          type: string
          description: Wishlist name
          example: Мой вишлист
          minLength: 1
          maxLength: 250
        image:
          type: string
          description: Wishlist cover image url
          example: https://i.pravatar.cc/150?img=3
        description:
          type: string
          description: Wishlist description
          maxLength: 1500
        itemsId:
          description: IDs of existing wishes to add to the wishlist
          example: &a6
            - 1
          type: array
          items:
            type: number
      required:
        - name
        - image
    UpdateWishlistDto:
      type: object
      properties:
        name:
          type: string
          description: Wishlist name
          example: Мой вишлист
          minLength: 1
          maxLength: 250
        image:
          type: string
          description: Wishlist cover image url
          example: https://i.pravatar.cc/150?img=3
        description:
          type: string
          description: Wishlist description
          maxLength: 1500
        itemsId:
          description: IDs of existing wishes to add to the wishlist
          example: *a6
          type: array
          items:
            type: number
    SigninUserDto:
      type: object
      properties:
        username:
          type: string
          description: Username
          example: exampleuser
          minLength: 1
          maxLength: 64
        password:
          type: string
          description: Password
          example: somestrongpassword
          minLength: 2
      required:
        - username
        - password
    SigninUserResponseDto:
      type: object
      properties:
        access_token:
          type: string
          description: JWT-токен
          example: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...
      required:
        - access_token
    CreateUserDto:
      type: object
      properties:
        username:
          type: string
          description: Username, unique string 2-30 characters
          example: johndoe
          minLength: 2
          maxLength: 30
        about:
          type: string
          description: About user, string 2-200 characters
          example: Пока ничего не рассказал о себе
          minLength: 2
          maxLength: 200
        avatar:
          type: string
          description: Avatar URL
          example: https://i.pravatar.cc/300
        email:
          type: string
          description: User email, must be unique
          example: test@example.com
        password:
          type: string
          description: User password, min 6 characters
          example: secret123
          minLength: 6
      required:
        - username
        - email
        - password
    SignupUserResponseDto:
      type: object
      properties:
        id:
          type: number
          example: 5
        username:
          type: string
          example: user
          minLength: 1
          maxLength: 64
        about:
          type: string
          example: Пока ничего не рассказал о себе
          minLength: 1
          maxLength: 200
        avatar:
          type: string
          example: https://i.pravatar.cc/300
        email:
          type: string
          example: user@yandex.ru
        createdAt:
          format: date-time
          type: string
        updatedAt:
          format: date-time
          type: string
      required:
        - id
        - username
        - about
        - avatar
        - email
        - createdAt
        - updatedAt
